<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Geojoin::Index</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Geojoin::Index</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/geojoin_rb.html">
                geojoin.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The <a href="Index.html">Index</a> class provides an in-memory spatial
index of features, and methods for iterating over them efficiently.
</p>
<p>
The <a href="Index.html">Index</a> class wraps the STR tree class provided
by GEOS. The STR tree structure is very fast on queries, but its primary
limitation is that the index can be built only once. The first time that a
spatial query is performed, the index is constructed and becomes read-only.
Therefore, you must add all of the features you wish to query against to
the index <b>first</b>, before performing any queries against it.
</p>
<p>
All of the query methods in this class take a &quot;query&quot; feature as
an argument. The containment-testing query method presume that the query
feature is a (multi)polygon.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000011">&lt;&lt;</a>&nbsp;&nbsp;
      <a href="#M000014">contained_by</a>&nbsp;&nbsp;
      <a href="#M000017">count</a>&nbsp;&nbsp;
      <a href="#M000013">each</a>&nbsp;&nbsp;
      <a href="#M000015">intersects_with</a>&nbsp;&nbsp;
      <a href="#M000022">max</a>&nbsp;&nbsp;
      <a href="#M000019">mean</a>&nbsp;&nbsp;
      <a href="#M000021">min</a>&nbsp;&nbsp;
      <a href="#M000010">new</a>&nbsp;&nbsp;
      <a href="#M000012">push</a>&nbsp;&nbsp;
      <a href="#M000016">relates_to</a>&nbsp;&nbsp;
      <a href="#M000020">stddev</a>&nbsp;&nbsp;
      <a href="#M000018">sum</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000010" class="method-detail">
        <a name="M000010"></a>

        <div class="method-heading">
          <a href="Index.src/M000010.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000010.html');return false;">
          <span class="method-name">new</span><span class="method-args">(features=[])</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The <a href="Index.html#M000010">new</a>() method takes an optional Array
of features.
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000011" class="method-detail">
        <a name="M000011"></a>

        <div class="method-heading">
          <a href="Index.src/M000011.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000011.html');return false;">
          <span class="method-name">&lt;&lt;</span><span class="method-args">(feature)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add a feature to the index. The &lt;&lt; method takes either a <a
href="Feature.html">Feature</a> object or a two-element Array as its sole
argument. If an Array is provided, its contents are used as the arguments
to <a href="Feature.html#M000001">Feature.new</a>(), and then the <a
href="Index.html#M000010">new</a> feature is inserted into the index.
</p>
        </div>
      </div>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="Index.src/M000014.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000014.html');return false;">
          <span class="method-name">contained_by</span><span class="method-args">(feature) {|match if contained| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Given a query feature, iterates over all features in the index that are
contained by the query feature, and yields <a
href="Index.html#M000013">each</a> to the given block. Presumes that the
query feature is a (multi)polygon.
</p>
<p>
The precise method used for testing for containment is as follows:
</p>
<ul>
<li>Does the query feature completely contain the indexed feature?

</li>
<li>Otherwise, does the query feature contain the indexed feature&#8216;s
centroid, <b>and</b> intersect with the indexed feature?

</li>
</ul>
<p>
Using these criteria, every feature in the index will be mapped one-to-one
with a set of non-overlapping query geometries encompassing the geometric
plane, except for those which overlap more than one feature <b>and</b> have
a centroid lying precisely on a topological boundary.
</p>
<p>
Calling this method causes the index to become read-only.
</p>
        </div>
      </div>

      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">
          <a href="Index.src/M000017.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000017.html');return false;">
          <span class="method-name">count</span><span class="method-args">(feature)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Index.html#M000017">count</a> of all features in the
index contained by the given query feature.
</p>
<p>
Calling this method causes the index to become read only.
</p>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="Index.src/M000013.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000013.html');return false;">
          <span class="method-name">each</span><span class="method-args">() {|feature| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iterates over the index, passing <a href="Index.html#M000013">each</a>
feature to the given block. The <a href="Index.html#M000013">each</a>()
method does <b>not</b> trigger the construction of the index.
</p>
        </div>
      </div>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="Index.src/M000015.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000015.html');return false;">
          <span class="method-name">intersects_with</span><span class="method-args">(feature) {|match if intersects| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Given a query feature, iterates over all features in the index that
intersect with the query feature, and yields <a
href="Index.html#M000013">each</a> to the given block.
</p>
<p>
Calling this method causes the index to become read only.
</p>
        </div>
      </div>

      <div id="method-M000022" class="method-detail">
        <a name="M000022"></a>

        <div class="method-heading">
          <a href="Index.src/M000022.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000022.html');return false;">
          <span class="method-name">max</span><span class="method-args">(feature, key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the maximum value across all features in the index contained by the
given query feature. The value of <a href="Index.html#M000013">each</a>
feature is obtained by looking up the provided key in the indexed
feature&#8216;s data object.
</p>
<p>
Calling this method causes the index to become read only.
</p>
        </div>
      </div>

      <div id="method-M000019" class="method-detail">
        <a name="M000019"></a>

        <div class="method-heading">
          <a href="Index.src/M000019.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000019.html');return false;">
          <span class="method-name">mean</span><span class="method-args">(feature, key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Index.html#M000019">mean</a> value across all features
in the index contained by the given query feature. The value of <a
href="Index.html#M000013">each</a> feature is obtained by looking up the
provided key in the indexed feature&#8216;s data object.
</p>
<p>
Calling this method causes the index to become read only.
</p>
        </div>
      </div>

      <div id="method-M000021" class="method-detail">
        <a name="M000021"></a>

        <div class="method-heading">
          <a href="Index.src/M000021.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000021.html');return false;">
          <span class="method-name">min</span><span class="method-args">(feature, key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the minimum value across all features in the index contained by the
given query feature. The value of <a href="Index.html#M000013">each</a>
feature is obtained by looking up the provided key in the indexed
feature&#8216;s data object.
</p>
<p>
Calling this method causes the index to become read only.
</p>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="Index.src/M000012.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000012.html');return false;">
          <span class="method-name">push</span><span class="method-args">(*features)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds one or more features to the index.
</p>
        </div>
      </div>

      <div id="method-M000016" class="method-detail">
        <a name="M000016"></a>

        <div class="method-heading">
          <a href="Index.src/M000016.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000016.html');return false;">
          <span class="method-name">relates_to</span><span class="method-args">(feature) {|[match, Relation.new(feature, match)]| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Given a query feature, iterates over all features in the index whose
bounding boxes intersect with that of the query feature, and yields to the
given block an array consisting of the indexed feature and the
corresponding <a href="Relation.html">Relation</a> object.
</p>
<p>
Calling this method causes the index to become read only.
</p>
        </div>
      </div>

      <div id="method-M000020" class="method-detail">
        <a name="M000020"></a>

        <div class="method-heading">
          <a href="Index.src/M000020.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000020.html');return false;">
          <span class="method-name">stddev</span><span class="method-args">(feature, key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the population standard deviation across all features in the index
contained by the given query feature. The value of <a
href="Index.html#M000013">each</a> feature is obtained by looking up the
provided key in the indexed feature&#8216;s data object.
</p>
<p>
Calling this method causes the index to become read only.
</p>
        </div>
      </div>

      <div id="method-M000018" class="method-detail">
        <a name="M000018"></a>

        <div class="method-heading">
          <a href="Index.src/M000018.html" target="Code" class="method-signature"
            onclick="popupCode('Index.src/M000018.html');return false;">
          <span class="method-name">sum</span><span class="method-args">(feature, key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Index.html#M000018">sum</a> of a value across all
features in the index contained by the given query feature. The value of <a
href="Index.html#M000013">each</a> feature is obtained by looking up the
provided key in the indexed feature&#8216;s data object.
</p>
<p>
Calling this method causes the index to become read only.
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>